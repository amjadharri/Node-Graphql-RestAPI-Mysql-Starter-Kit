import DB from "./../../database/database.js";
import {validateAccessToken} from `${__dirname}/app/framework/validation/index.js`

class {{controllerName name}}Controller {
	constructor() {
		// constructor method
	}
	async {{controllerName name}}ViewAll(_, args) {
		try {
			await validateAccessToken();
			let argsWhere = {...args};
			delete argsWhere['page'];
			delete argsWhere['limit'];
			return DB.models.{{toLowerCase name}}.findAll({
				where: argsWhere,
				limit: args.limit || 20,
				offset: args.page
			})
		} catch (e) {
			return {
				errorMessageType: 'Backend Error',
				errorMessage: `Something went wrong, ${e.message}`
			}
		}
	}


	async {{controllerName name}}Create(_, args) {
		try {
			await validateAccessToken();
			try {
				return DB.models.{{toLowerCase name}}.create(args);
			}catch (e) {
				return {
					errorMessageType: 'Backend Error',
					errorMessage: `Something went wrong while creating {{controllerName name}}, ${e.message}`
				}
			}
		} catch (e) {
			return {
				errorMessageType: 'Backend Error',
				errorMessage: `Something went wrong, ${e.message}`
			}
		}
	}

	async {{controllerName name}}Update(_, args) {
		try {
			await validateAccessToken();
			let a = await DB.models.{{toLowerCase name}}.findById(args.id);
			if (a) {
				await a.updateAttributes(args);
				return a;
			}else {
				return {
					errorMessageType: 'Not Found',
					errorMessage: `Record not found to update.`
				}
			}
			return a;
		} catch (e) {
			return {
				errorMessageType: 'Backend Error',
				errorMessage: `Something went wrong, ${e.message}`
			}
		}
	}

	async {{controllerName name}}Delete(_, args) {
		try {
			await validateAccessToken();
			await DB.models.{{toLowerCase name}}.destroy({
				where: {
					id: args.id
				}
			});
			return {
				successMessageType: '{{controllerName name}} Delete',
				successMessage: `{{controllerName name}} Delete successfully`
			}
		} catch (e) {
			return {
				errorMessageType: 'Backend Error',
				errorMessage: `Something went wrong, ${e.message}`
			}
		}
	}

	async {{controllerName name}}View(_, args) {
		try {
			await validateAccessToken();
			return await DB.models.{{ toLowerCase name }}.findById(args.id);
		} catch (e) {
			return {
				errorMessageType: 'Backend Error',
				errorMessage: `Something went wrong, ${e.message}`
			}
		}
	}
}


export default new {{controllerName name}}Controller